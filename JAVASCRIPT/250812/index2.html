<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        const xhr1 = new XMLHttpRequest();
        const products = [];

        xhr1.open('GET', 'https://dev.wenivops.co.kr/services/fastapi-crud/1/product');
        xhr1.onreadystatechange = function () {
            if (xhr1.readyState === 4 && xhr1.status === 200) {
                products = JSON.parse(xhr1.responseText);
                console.log('상품 목록:', products);
                if (products.length > 0) {
                    // 첫 번째 상품의 상세 정보 요청
                    const productId = products[0].id;
                    const xhr2 = new XMLHttpRequest();
                    xhr2.open('GET', `https://dev.wenivops.co.kr/services/fastapi-crud/1/product/${productId}`);
                    xhr2.onreadystatechange = function () {
                        if (xhr2.readyState === 4 && xhr2.status === 200) {
                            const productDetail = JSON.parse(xhr2.responseText);
                            console.log('상품 상세 정보:', productDetail);

                            // 해당 상품 정보 수정
                            const updatedProduct = { ...productDetail, price: productDetail.price + 1000 };
                            const xhr3 = new XMLHttpRequest();
                            xhr3.open('PUT', `https://dev.wenivops.co.kr/services/fastapi-crud/1/product/${productId}`);
                            xhr3.setRequestHeader('Content-Type', 'application/json');
                            xhr3.onreadystatechange = function () {
                                if (xhr3.readyState === 4) {
                                    if (xhr3.status === 200) {
                                        const response = JSON.parse(xhr3.responseText);
                                        console.log('상품 수정 결과:', response);
                                    } else {
                                        console.error('상품 수정 실패:', xhr3.status);
                                    }
                                }
                            };
                            xhr3.send(JSON.stringify(updatedProduct));
                        } else if (xhr2.readyState === 4) {
                            console.error('상품 상세 정보 가져오기 실패:', xhr2.status);
                        }
                    };
                    xhr2.send();
                }

            } else if (xhr1.readyState === 4) {
                console.error('상품 목록 가져오기 실패:', xhr1.status);
            }
        };
        xhr1.send();


        products.forEach();
    </script>
</body>

</html>